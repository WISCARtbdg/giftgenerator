<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<title>Gift Profile Mini‚ÄëApp</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
    /* –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–∞—è –º–æ–¥–∞–ª–∫–∞ –≤–º–µ—Å—Ç–æ –±–µ–ª–æ–≥–æ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ */
#modal {padding:0; background:var(--bg-modal);}
#modal-inner{           /* —Ä–∞—Å—Ç—è–≥–∏–≤–∞–µ–º –Ω–∞ 100‚ÄØ% */
  width:100%; height:100%; border-radius:0; padding:16px;
  display:flex; flex-direction:column;
}
/* —Å–∫—Ä–æ–ª–ª–∏–º –≤–Ω—É—Ç—Ä–∏, –∞ –Ω–µ –ø–æ body */
#gift-scroll{flex:1; overflow-y:auto; padding-bottom:80px;}
/* GRID 3√óN */
.gift-grid{
  display:grid; grid-template-columns:repeat(3,1fr); gap:12px;
}
/* –∫–∞—Ä—Ç–æ—á–∫–∞ */
.gift-card{
  background:#1c1c1c; border-radius:12px; padding:12px;
  display:flex; flex-direction:column; align-items:center;
  transition:transform .15s;
}
.gift-card:hover{transform:translateY(-4px);}
.gift-card img{width:72px;height:72px;object-fit:contain}
.price{
  margin-top:6px; font-size:14px; color:#FFC107;
  display:flex; align-items:center; gap:4px;
}
.price::before{content:"‚òÖ"; color:#FFC107;}

  :root{
    --tg-blue:#30A4F2; --tg-yellow:#FFCC00; --tg-violet:#6C5CFF; --tg-teal:#00C896;
    --bg-modal:rgba(0,0,0,.75); --bg-btn:#1D9BF0;
  }
  *{box-sizing:border-box;margin:0;padding:0;font-family:sans-serif;}
  /* ‚ñ∏ –ì—Ä–∞–¥–∏–µ–Ω—Ç: —Ü–µ–Ω—Ç—Ä —Ç—ë–º–Ω—ã–π, –∫ –∫—Ä–∞—è–º —Å–≤–µ—Ç–ª–µ–µ */
  body{
    min-height:100vh;display:flex;flex-direction:column;align-items:center;text-align:center;
    background:radial-gradient(circle,#2b2b2b 0%,#3d3d3d 40%,#5a5a5a 100%);color:#fff;
  }
  #avatar-box{position:relative;margin-top:40px}
  #avatar{width:160px;height:160px;border-radius:50%;object-fit:cover;border:4px solid var(--tg-blue);}
  #gift-layer{position:absolute;inset:0;width:160px;height:160px;pointer-events:none;}

  #name{margin-top:12px;font-size:20px;font-weight:600;}
  #gift-btn{
    position:fixed;left:50%;bottom:16px;transform:translateX(-50%);
    background:var(--bg-btn);color:#fff;border:none;border-radius:24px;
    padding:14px 32px;font-size:18px;cursor:pointer;box-shadow:0 4px 10px rgba(0,0,0,.15);
  }

  /* ‚îÄ‚îÄ –ú–æ–¥–∞–ª–∫–∞ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
  #modal{display:none;position:fixed;inset:0;background:var(--bg-modal);padding:24px;overflow:auto;}
  #modal.show{display:block;}
  #modal-inner{background:#fff;color:#222;border-radius:12px;padding:20px;max-width:420px;margin:40px auto;}
  h3{margin:12px 0 8px;font-size:18px;}
  .gift-option{width:40px;height:40px;border-radius:8px;object-fit:cover;cursor:pointer;margin:6px;filter:grayscale(20%);}
  .gift-option.selected{outline:3px solid var(--tg-blue);}
  .bg-option{width:36px;height:36px;border-radius:50%;display:inline-block;cursor:pointer;margin:4px;border:2px solid transparent;}
  .bg-option.selected{border-color:#000;}
  #next,#save{margin-top:18px;padding:10px 24px;font-size:16px;border:none;border-radius:20px;color:#fff;cursor:pointer;}
  #next{background:var(--tg-blue);}
  #save{background:var(--tg-teal);}
  /* —Å–∫—Ä—ã–≤–∞–µ–º –≤—Ç–æ—Ä–æ–π —à–∞–≥ –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –Ω–µ –≤—ã–±–µ—Ä—É—Ç –ø–æ–¥–∞—Ä–æ–∫ */
  .step{display:none;}
  .step.active{display:block;}
</style>
</head>

<body>
  <div id="avatar-box">
    <img id="avatar" src="https://placehold.co/160x160?text=%F0%9F%92%BB" alt="avatar">
    <img id="gift-layer" src="" alt="" style="display:none;">
  </div>
  <div id="name">–ì–æ—Å—Ç—å</div>

  <button id="gift-btn">–ü–æ–¥–∞—Ä–∫–∏ üéÅ</button>

  <!-- –ú–û–î–ê–õ–ö–ê -->
  <!-- —Å—Ç–∞–ª–æ -->
<div id="modal">
  <div id="modal-inner">
    <!-- –∫–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç—å -->
    <button id="close"
            style="align-self:flex-end;background:none;border:none;color:#fff;font-size:20px;">
      ‚úï
    </button>

    <!-- –æ–±–ª–∞—Å—Ç—å –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ -->
    <div id="gift-scroll">
      <!-- —Å—é–¥–∞ JS –ø–æ–ª–æ–∂–∏—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ -->
      <div class="gift-grid" id="gift-grid"></div>
    </div>
  </div>
</div>


<script>
const tg = window.Telegram.WebApp; tg.ready();
const user = tg.initDataUnsafe?.user || {};
document.getElementById('name').textContent = user.first_name || '–ì–æ—Å—Ç—å';
if (user.photo_url) document.getElementById('avatar').src = user.photo_url;

/* ---------- –î–ê–ù–ù–´–ï ---------- */
const gifts = [
  {id:1,gif:'/snup1.gif',color:'#30A4F2'},
  {id:2,gif:'',color:'#30A4F2'},
  {id:3,gif:'',color:'#30A4F2'},
  {id:4,gif:'',color:'#30A4F2'},
  {id:5,gif:'',color:'#30A4F2'},
  {id:6,gif:'',color:'#30A4F2'},
  {id:7,gif:'',color:'#30A4F2'},
  {id:8,gif:'',color:'#30A4F2'},
  {id:9,gif:'',color:'#30A4F2'},
  {id:10,gif:'',color:'#30A4F2'},
  {id:11,gif:'',color:'#30A4F2'},
  {id:12,gif:'',color:'#30A4F2'},
  {id:13,gif:'',color:'#30A4F2'},
  {id:14,gif:'',color:'#30A4F2'},
  {id:15,gif:'',color:'#30A4F2'},
  {id:16,gif:'',color:'#30A4F2'},
  {id:17,gif:'',color:'#30A4F2'},
  {id:18,gif:'',color:'#30A4F2'},
  {id:19,gif:'',color:'#30A4F2'},
  {id:20,gif:'',color:'#30A4F2'},
  {id:21,gif:'',color:'#30A4F2'},
  {id:22,gif:'',color:'#30A4F2'},
  {id:23,gif:'',color:'#30A4F2'},
  {id:24,gif:'',color:'#30A4F2'},
  {id:25,gif:'',color:'#30A4F2'},
  {id:26,gif:'',color:'#30A4F2'},
  {id:27,gif:'',color:'#30A4F2'},
  {id:28,gif:'',color:'#30A4F2'},
  {id:29,gif:'',color:'#30A4F2'},
  {id:30,gif:'',color:'#30A4F2'},
  {id:31,gif:'',color:'#30A4F2'},
  {id:32,gif:'',color:'#30A4F2'},
  {id:33,gif:'',color:'#30A4F2'},
  {id:34,gif:'',color:'#30A4F2'},
  {id:25,gif:'',color:'#30A4F2'},
  {id:36,gif:'',color:'#30A4F2'},
  {id:37,gif:'',color:'#30A4F2'},
  {id:38,gif:'',color:'#30A4F2'},
  {id:39,gif:'',color:'#30A4F2'},
  {id:40,gif:'',color:'#30A4F2'},
  {id:41,gif:'',color:'#30A4F2'},
  {id:42,gif:'',color:'#30A4F2'},
  {id:43,gif:'',color:'#30A4F2'},
  {id:44,gif:'',color:'#30A4F2'},
  {id:45,gif:'',color:'#30A4F2'},
  {id:46,gif:'',color:'#30A4F2'},
  {id:47,gif:'',color:'#30A4F2'},
  {id:48,gif:'',color:'#30A4F2'},
  {id:49,gif:'',color:'#30A4F2'},
  {id:50,gif:'',color:'#30A4F2'},
  {id:51,gif:'',color:'#30A4F2'},
  {id:52,gif:'',color:'#30A4F2'},
  {id:53,gif:'',color:'#30A4F2'},
  {id:54,gif:'',color:'#30A4F2'},
  {id:55,gif:'',color:'#30A4F2'},
];
const backgrounds = ['#30A4F2','#FFCC00','#6C5CFF','#00C896'];

/* ---------- –†–ï–ù–î–ï–† ---------- */
const grid = document.getElementById('gift-grid');
gifts.forEach(g=>{
  const card=document.createElement('div');
  card.className='gift-card';
  card.innerHTML = `
    <img src="${g.gif}" alt="">
    <div class="price">${g.price}</div>
  `;
  card.onclick = ()=>{                // –≤—ã–±–æ—Ä –ø–æ–¥–∞—Ä–∫–∞ ‚ûú –ø—Ä–µ–≤—å—é –ø–æ–≤–µ—Ä—Ö –∞–≤–∞—Ç–∞—Ä–∞
    selectedGift=g;
    preview();
    modal.classList.remove('show');   // –∑–∞–∫—Ä—ã–≤–∞–µ–º
  };
  grid.appendChild(card);
});

const giftList = document.getElementById('gift-list');
gifts.forEach(g=>{
  const img=document.createElement('img');
  img.className='gift-option'; img.src=g.gif;
  img.onclick=()=>selectGift(g,img);
  giftList.appendChild(img);
});
const bgList=document.getElementById('bg-list');
backgrounds.forEach(c=>{
  const d=document.createElement('span');
  d.className='bg-option'; d.style.background=c;
  d.onclick=()=>selectBg(c,d);
  bgList.appendChild(d);
});

/* ---------- –õ–û–ì–ò–ö–ê ---------- */
let selectedGift=null, selectedBg=null;
function selectGift(g,el){
  selectedGift=g;
  document.querySelectorAll('.gift-option').forEach(x=>x.classList.remove('selected'));
  el.classList.add('selected');
  document.getElementById('next').disabled=false;
}
function selectBg(c,el){
  selectedBg=c;
  document.querySelectorAll('.bg-option').forEach(x=>x.classList.remove('selected'));
  el.classList.add('selected');
  preview();
}
function preview(){
  const img=document.getElementById('gift-layer');
  if(selectedGift){ img.src=selectedGift.gif; img.style.display='block'; }
  if(selectedBg){ document.body.style.background=`radial-gradient(circle,${selectedBg} 0%,${selectedBg}40%,#5a5a5a 100%)`; }
}

/* —à–∞–≥–∏ –º–æ–¥–∞–ª–∫–∏ */
const stepGift=document.getElementById('step‚Äëgift');
const stepBg=document.getElementById('step‚Äëbg');
// --- –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è / –∑–∞–∫—Ä—ã—Ç–∏—è ---
const modal = document.getElementById('modal');
document.getElementById('gift-btn').onclick = () => modal.classList.add('show');   // –æ—Ç–∫—Ä—ã—Ç—å
document.getElementById('close').onclick    = () => modal.classList.remove('show'); // ¬´‚úï¬ª
modal.onclick = e => { if (e.target.id === 'modal') modal.classList.remove('show'); }; // –∫–ª–∏–∫ –ø–æ –∑–∞—Ç–µ–º–Ω—ë–Ω–∫–µ
// --------------------------------------

function openStep(step){ [stepGift,stepBg].forEach(s=>s.classList.remove('active')); step.classList.add('active'); }
openStep(stepGift);

document.getElementById('next').onclick=()=>openStep(stepBg);


document.getElementById('save').onclick=async()=>{
  document.getElementById('modal').classList.remove('show');
  preview(); // –ø—Ä–∏–º–µ–Ω—è–µ–º –≤—ã–±–æ—Ä
  // –∑–¥–µ—Å—å –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å API /save
};
</script>
</body>
</html>
